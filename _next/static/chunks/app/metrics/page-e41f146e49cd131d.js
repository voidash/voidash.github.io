(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{550:(e,t,n)=>{"use strict";n.d(t,{db:()=>a,j:()=>l,y:()=>o});var s=n(2078),i=n(9708),r=n(9253);let o=(0,s.Dk)().length?(0,s.Dk)()[0]:(0,s.Wp)({apiKey:"AIzaSyCwVnyj4j9vVEu88BXKxd6-4sNa-mkduVI",authDomain:"ask-me-anything-voidash.firebaseapp.com",projectId:"ask-me-anything-voidash",storageBucket:"ask-me-anything-voidash.firebasestorage.app",messagingSenderId:"695897255699",appId:"1:695897255699:web:fef029a271b72ee38f74e6",measurementId:"G-43LRB0V3BW"}),a=(0,i.aU)(o),l=(0,r.xI)(o)},2880:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,9907,23)),Promise.resolve().then(n.bind(n,9827)),Promise.resolve().then(n.bind(n,6621))},3510:(e,t,n)=>{"use strict";function s(e){let t=e.split("\n"),n=[];for(let e of t){let t=e.match(/^[\s-]*\[([x X ])\]\s*(.*)$/i);if(t){let e="x"===t[1].toLowerCase(),s=t[2].trim(),i=(s.match(/#[\w-]+/g)||[]).map(e=>e.toLowerCase());n.push({completed:e,text:s,tags:i})}}return n}function i(e){let t=e.filter(e=>e.completed);return{learningArtifacts:t.filter(e=>e.tags.includes("#learn")).length,revisionPointsReviewed:t.filter(e=>e.tags.includes("#review")).length,revisionNotesCreated:t.filter(e=>e.tags.includes("#new-review")).length,publicOutputs:t.filter(e=>e.tags.includes("#produce")).length,newInteractions:t.filter(e=>e.tags.includes("#relationship")).length,gymSessions:t.filter(e=>e.tags.includes("#gym")).length,familyCalls:t.filter(e=>e.tags.includes("#family")).length,conflictsResolved:t.filter(e=>e.tags.includes("#conflict-resolved")).length,unresolvedConflicts:t.filter(e=>e.tags.includes("#conflict-unresolved")).length}}function r(e,t){let n=s(e),i=[],r={"#learning-todo":"learning","#producer-todo":"producer","#finance-todo":"finance","#fitness-todo":"fitness","#relationship-todo":"relationship"};for(let e of n)for(let[n,s]of Object.entries(r))if(e.tags.includes(n)){let r=e.text.replace(n,"").trim();i.push({text:r,label:s,sourceDate:t,completed:e.completed,createdAt:new Date().toISOString()});break}return i}function o(e){let t=s(e).filter(e=>e.completed),n="none";t.some(e=>e.tags.includes("#finance-concept"))&&(n="implemented");let i="none",r=t.some(e=>e.tags.includes("#ips-check")),o=t.some(e=>e.tags.includes("#portfolio-review"));return r?i="ips_checked":o&&(i="reviewed"),{financeConceptApplied:n,portfolioReview:i}}n.d(t,{Kk:()=>o,Z7:()=>r,Zg:()=>s,zP:()=>i})},6621:(e,t,n)=>{"use strict";n.d(t,{ThemeToggle:()=>o});var s=n(5155),i=n(5379),r=n(2115);function o(){let[e,t]=(0,r.useState)(!1),{theme:n,setTheme:o}=(0,i.D)();return((0,r.useEffect)(()=>{t(!0)},[]),e)?(0,s.jsx)("button",{onClick:()=>o("dark"===n?"light":"dark"),className:"theme-toggle","aria-label":"Toggle theme",children:"dark"===n?"Light":"Dark"}):null}},6707:(e,t,n)=>{"use strict";n.d(t,{A:()=>c,AuthProvider:()=>l});var s=n(5155),i=n(2115),r=n(9253),o=n(550);let a=(0,i.createContext)({user:null,loading:!0,signInWithGoogle:async()=>{},logOut:async()=>{}});function l(e){let{children:t}=e,[n,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=(0,r.hg)(o.j,e=>{l(e),d(!1)});return()=>e()},[]);let g=async()=>{let e=new r.HF;await (0,r.df)(o.j,e)},p=async()=>{await (0,r.CI)(o.j)};return(0,s.jsx)(a.Provider,{value:{user:n,loading:c,signInWithGoogle:g,logOut:p},children:t})}function c(){return(0,i.useContext)(a)}},9827:(e,t,n)=>{"use strict";n.d(t,{default:()=>W});var s=n(5155),i=n(2115),r=n(2619),o=n.n(r),a=n(63),l=n(550),c=n(9708);function d(e,t,n){if(e=isNaN(e)||!isFinite(e)?0:e,t=isNaN(t)||!isFinite(t)?0:t,n=isNaN(n)||!isFinite(n)?0:n,0===e&&0===t&&0===n)return 0;let s=Math.min(1,n/Math.max(1,e)),i=(n-t)/Math.max(1,e),r=100*(.6*s+.4*(i>=0?.5+Math.min(.5,.5*i):Math.max(0,.5+i)));return isNaN(r)||!isFinite(r)?0:r}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return isNaN(e)||!isFinite(e)?t:e}function p(e){let t=100*!!e.management.weeklyLogSetup,n=g(100*(e.management.dailyLoggedDays/7)),s=100*!!e.management.financeLogSetup,i=g(.4*t+.3*n+.3*s),r=g(e.learning.loggedDays/7),o=g(e.learning.learningArtifactsCount*r),a=g(Math.min(100,100*(o/Math.max(1,e.targets.artifactsPerWeek)))),l=g(10*e.learning.revisionNotesCreated+e.learning.revisionRevisitPoints),c=g(l*r),p=g(Math.min(100,c/35*100)),h=d(e.learning.learningTodo.s0,e.learning.learningTodo.add,e.learning.learningTodo.close),m=g(.3*a+.4*p+.3*h),u=g(Math.min(100,100*e.producer.publicOutputsCount)),x=d(e.producer.producerTodo.s0,e.producer.producerTodo.add,e.producer.producerTodo.close),f=g(.5*u+.5*x),y=g((e.finance.income-e.finance.spend)/Math.max(1,e.finance.income)),v=g(Math.min(1,y/Math.max(.01,e.finance.targetSavingsRate))),w=g(Math.min(1,e.finance.spendCap/Math.max(e.finance.spend,e.finance.spendCap))),j=g(100*(.5*v+.5*w)),k="implemented"===e.finance.financeConceptApplied?100:50*("noted"===e.finance.financeConceptApplied),b="ips_checked"===e.finance.portfolioReview?100:60*("reviewed"===e.finance.portfolioReview),C=d(e.finance.financeTodo.s0,e.finance.financeTodo.add,e.finance.financeTodo.close),S=g(.2*j+.2*k+.2*b+.4*C),N=g(e.fitness.loggedDays/7),M=g(e.fitness.gymSessions*N),W=g(Math.min(100,100*(M/Math.max(1,e.targets.gymSessionsPerWeek)))),T=g(Math.abs(e.fitness.avgWeightActual-e.fitness.targetWeight)),_=e.fitness.targetWeight>0?g(Math.min(100,100*Math.exp(-.2*T))):0,A=g(100*(e.fitness.caloriesTrackedDays/7)),P=d(e.fitness.fitnessTodo.s0,e.fitness.fitnessTodo.add,e.fitness.fitnessTodo.close),F=g(.4*W+.3*_+.2*A+.1*P),B=g(Math.min(100,100*(e.relationship.newInteractions/Math.max(1,e.targets.newInteractionsPerWeek)))),D=g(Math.min(100,100*(e.relationship.familyCalls/Math.max(1,e.targets.familyCallsPerWeek)))),R=d(e.relationship.relationshipTodo.s0,e.relationship.relationshipTodo.add,e.relationship.relationshipTodo.close),I=e.relationship.unresolvedConflicts>0?Math.min(R,80):R,L=g(.6*B+.1*D+.3*I);return{management:{score:i,components:[{name:"Weekly log exists",score:t,weight:.4},{name:"Days actually logged",score:n,weight:.3},{name:"Finance tracking active",score:s,weight:.3}]},learning:{score:m,components:[{name:"New stuff learned",score:a,weight:.3},{name:"Old stuff reviewed",score:p,weight:.4},{name:"Backlog health",score:h,weight:.3}]},producer:{score:f,components:[{name:"Shipped work",score:u,weight:.5},{name:"Backlog health",score:x,weight:.5}]},finance:{score:S,components:[{name:"Money in vs out",score:j,weight:.2},{name:"Concept applied",score:k,weight:.2},{name:"Portfolio checked",score:b,weight:.2},{name:"Backlog health",score:C,weight:.4}]},fitness:{score:F,components:[{name:"Sessions completed",score:W,weight:.4},{name:"Weight target hit",score:_,weight:.3},{name:"Food tracked",score:A,weight:.2},{name:"Backlog health",score:P,weight:.1}]},relationship:{score:e.relationship.primaryRelationshipActive?Math.max(60,L):L,components:[{name:"Met new people",score:B,weight:.6},{name:"Called family",score:D,weight:.1},{name:"Conflicts + backlog",score:I,weight:.3}]}}}var h=n(3510),m=n(6707),u=n(4466),x=n(3799),f=n(6411),y=n(2909),v=n(8230),w=n(3272),j=n(987),k=n(712);function b(e){return e>=80?"green":e>=60?"yellow":"red"}n(6105),n(9907);let C={management:{title:"Management",subtitle:"Tracking foundations",description:"Weekly log setup, daily notes used consistently, finance tracking maintained."},learning:{title:"Learning",subtitle:"New knowledge & review",description:"Learning artifacts created (papers, code, proofs), revision notes made, old concepts revisited."},producer:{title:"Producer",subtitle:"Shipped work",description:"Blog posts published, videos released, PRs merged. Closing tasks faster than adding them."},finance:{title:"Finance",subtitle:"Money discipline",description:"Hitting savings targets, staying under spend cap, learning new concepts, portfolio reviewed."},fitness:{title:"Fitness",subtitle:"Physical progress",description:"Gym sessions completed, actual weight vs target weight, calories tracked."},relationship:{title:"Relationship",subtitle:"People & connections",description:"New interactions, family calls, conflicts resolved. Min 60 if in primary relationship."}};function S(e){let{scores:t,weekStart:n,weekEnd:i}=e,r=[{axis:"Mgmt",score:Math.round(t.management.score)},{axis:"Learn",score:Math.round(t.learning.score)},{axis:"Producer",score:Math.round(t.producer.score)},{axis:"Finance",score:Math.round(t.finance.score)},{axis:"Fitness",score:Math.round(t.fitness.score)},{axis:"Relation",score:Math.round(t.relationship.score)}];return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"radar-section",children:[(0,s.jsx)("h2",{className:"radar-title",children:"Weekly Overview"}),(0,s.jsx)(u.u,{width:"100%",height:500,children:(0,s.jsxs)(x.V,{data:r,children:[(0,s.jsx)(f.z,{stroke:"var(--border-color)"}),(0,s.jsx)(y.r,{dataKey:"axis",tick:{fill:"var(--text-primary)",fontSize:14}}),(0,s.jsx)(v.E,{angle:90,domain:[0,100],tick:{fill:"var(--text-secondary)",fontSize:12}}),(0,s.jsx)(w.V,{name:"Score",dataKey:"score",stroke:"#0066cc",fill:"#0066cc",fillOpacity:.3,strokeWidth:2}),(0,s.jsx)(j.s,{})]})}),n&&i&&(0,s.jsxs)("div",{style:{textAlign:"center",marginTop:"16px",padding:"8px",fontSize:"14px",color:"var(--text-secondary)",border:"1px solid var(--border-color)",fontFamily:"monospace"},children:["Week: ",n," to ",i]})]}),(0,s.jsx)("div",{className:"cards-grid",children:Object.entries(t).map(e=>{let[t,n]=e,i=C[t];return(0,s.jsxs)("div",{className:"axis-card",children:[(0,s.jsxs)("div",{className:"axis-header",children:[(0,s.jsx)("h3",{className:"axis-title",children:i.title}),(0,s.jsx)("span",{className:"axis-score ".concat(b(n.score)),children:Math.round(n.score)})]}),(0,s.jsx)("p",{className:"axis-subtitle",children:i.subtitle}),(0,s.jsxs)("div",{className:"components-section",children:[(0,s.jsx)("p",{className:"components-title",children:"Components"}),n.components.map((e,t)=>(0,s.jsxs)("div",{className:"component-item",children:[(0,s.jsxs)("div",{className:"component-header",children:[(0,s.jsxs)("span",{className:"component-name",children:[e.name," (",Math.round(100*e.weight),"%)"]}),(0,s.jsx)("span",{className:"component-score ".concat(b(e.score)),children:Math.round(e.score)})]}),(0,s.jsx)("div",{className:"component-bar",children:(0,s.jsx)("div",{className:"component-fill bg-".concat(b(e.score)),style:{width:"".concat(e.score,"%")}})})]},t))]}),(0,s.jsxs)("div",{style:{marginTop:"24px",padding:"20px",border:"2px solid var(--border-color)"},children:[(0,s.jsx)("div",{style:{fontSize:"16px",fontWeight:"700",marginBottom:"16px",borderBottom:"2px solid var(--border-color)",paddingBottom:"12px"},children:"Calculation Details"}),(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",border:"1px solid var(--border-color)"},children:[(0,s.jsx)("div",{style:{fontWeight:"600",marginBottom:"10px"},children:"Master Formula:"}),(0,s.jsx)("div",{style:{overflowX:"auto",overflowY:"hidden"},children:(0,s.jsx)(k.BlockMath,{math:function(e,t){let n=t.components.map(e=>e.weight);switch(e){case"management":case"learning":case"relationship":return"\\text{Score} = ".concat(n[0]," \\times a_1 + ").concat(n[1]," \\times a_2 + ").concat(n[2]," \\times a_3");case"producer":return"\\text{Score} = ".concat(n[0]," \\times a_1 + ").concat(n[1]," \\times a_2");case"finance":case"fitness":return"\\text{Score} = ".concat(n[0]," \\times a_1 + ").concat(n[1]," \\times a_2 + ").concat(n[2]," \\times a_3 + ").concat(n[3]," \\times a_4");default:return""}}(t,n)})})]}),(0,s.jsx)("div",{style:{marginTop:"16px"},children:function(e,t){let n=t.components,i=t.score,r=function(e){switch(e){case"management":return["a_1 = \\begin{cases} 100 & \\text{weekly log exists} \\\\ 0 & \\text{else} \\end{cases}","a_2 = 100 \\times \\frac{\\text{days logged}}{7}","a_3 = \\begin{cases} 100 & \\text{finance active} \\\\ 0 & \\text{else} \\end{cases}"];case"learning":return["a_1 = \\min\\left(100, 100 \\times \\frac{\\text{artifacts} \\times c}{\\text{target}}\\right), \\quad c = \\frac{\\text{logged}}{7}","a_2 = \\min\\left(100, 100 \\times \\frac{r \\times c}{35}\\right), \\quad r = 10n + p","a_3 = 100(0.6t + 0.4h)"];case"producer":return["a_1 = \\min(100, 100 \\times \\text{outputs})","a_2 = 100(0.6t + 0.4h)"];case"finance":return["a_1 = 100(0.5 \\times \\text{srn} + 0.5 \\times \\text{spn})","a_2 = \\begin{cases} 100 & \\text{implemented} \\\\ 50 & \\text{noted} \\\\ 0 & \\text{none} \\end{cases}","a_3 = \\begin{cases} 100 & \\text{IPS} \\\\ 60 & \\text{reviewed} \\\\ 0 & \\text{none} \\end{cases}","a_4 = 100(0.6t + 0.4h)"];case"fitness":return["a_1 = \\min\\left(100, 100 \\times \\frac{\\text{sessions} \\times c}{\\text{target}}\\right), \\quad c = \\frac{\\text{logged}}{7}","a_2 = 100 \\times e^{-0.2d}, \\quad d = |\\text{actual} - \\text{target}|","a_3 = 100 \\times \\frac{\\text{tracked days}}{7}","a_4 = 100(0.6t + 0.4h)"];case"relationship":return["a_1 = \\min\\left(100, 100 \\times \\frac{\\text{interactions}}{\\text{target}}\\right)","a_2 = \\min\\left(100, 100 \\times \\frac{\\text{calls}}{\\text{target}}\\right)","a_3 = \\begin{cases} \\min(\\text{todo}, 80) & \\text{conflicts} \\\\ \\text{todo} & \\text{else} \\end{cases}"];default:return[]}}(e),o=function(e){switch(e){case"learning":return"c=coverage, r=revision equivalent, n=new notes, p=review points, t=throughput (close/s0), h=hygiene (net change)";case"fitness":return"c=coverage, t=throughput (close/s0), h=hygiene (net change)";case"producer":case"finance":return"t=throughput (close/s0), h=hygiene (net change), net=(close-add)";case"relationship":return"t=throughput (close/s0), h=hygiene (net change)";default:return""}}(e);return(0,s.jsxs)("div",{style:{fontSize:"14px"},children:[o&&(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"12px",border:"1px solid var(--border-color)",fontSize:"12px",fontFamily:"monospace"},children:[(0,s.jsx)("strong",{children:"Variables:"})," ",o]}),n.map((e,t)=>(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"16px",border:"1px solid var(--border-color)"},children:[(0,s.jsxs)("div",{style:{fontWeight:"600",marginBottom:"12px",fontSize:"15px"},children:["Component ",t+1,": ",e.name," (",(100*e.weight).toFixed(0),"%)"]}),r[t]&&(0,s.jsx)("div",{style:{marginBottom:"12px",padding:"16px",border:"1px solid var(--border-color)",overflowX:"auto"},children:(0,s.jsx)(k.BlockMath,{math:r[t]})}),(0,s.jsxs)("div",{style:{padding:"10px",border:"1px solid var(--border-color)",fontFamily:"monospace",fontWeight:"600",fontSize:"14px"},children:["Result: a",(0,s.jsx)("sub",{children:t+1})," = ",e.score.toFixed(2)]})]},t)),(0,s.jsx)("div",{style:{marginTop:"24px",paddingTop:"20px",borderTop:"2px solid var(--border-color)"},children:(0,s.jsxs)("div",{style:{padding:"12px",border:"2px solid var(--border-color)",fontSize:"18px",fontWeight:"700",textAlign:"center"},children:["Final Score = ",i.toFixed(2)]})})]})}(t,n)})]})]},t)})}),(0,s.jsxs)("div",{className:"legend-section",children:[(0,s.jsx)("h3",{className:"legend-title",children:"Notes"}),(0,s.jsxs)("ul",{className:"legend-list",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Management"})," is the foundation. If you don't log consistently, the other scores become meaningless."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Learning"})," = ~3 new artifacts/week (papers with notes, code repos, proofs) + regular revision. Target: 35 revision points/week (could be 3 new notes + 5 reviews = 10\xd73 + 5 = 35, or 1 new note + 25 reviews = 10\xd71 + 25 = 35)."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Producer"})," = 1 public output/week gets you 100 on the output component. Blog post, video, merged PR."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Finance"})," = hitting your savings rate, staying under weekly spend cap, applying concepts, reviewing portfolio."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Fitness"})," = 3 quality gym sessions/week, hitting your target weight (from weekly log), tracking food. Weight score uses exponential decay: 100% at 0kg difference, ~82% at 1kg, ~67% at 2kg, ~55% at 3kg."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Relationship"})," = 3 new interactions/week, 2 family calls. Guaranteed min 60 if you're in a primary relationship."]}),(0,s.jsx)("li",{children:"If you only logged 5 of 7 days, all your scores get scaled down by 5/7. Log everything or pay the price."})]}),(0,s.jsx)("h3",{className:"legend-title",style:{marginTop:"30px"},children:"Variable Explanations"}),(0,s.jsxs)("ul",{className:"legend-list",children:[(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"n (new revision notes)"}),": Tasks tagged with #new-review. Creating NEW summary notes from old material. Each note = 10 points."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"p (review points)"}),": Tasks tagged with #review. Reviewing EXISTING material or notes. Each review = 1 point."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"r (revision equivalent)"}),": Total revision score = 10n + p. Example: 2 new notes + 5 reviews = 10(2) + 5 = 25 points."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"c (coverage)"}),": Logging coverage = logged days / 7. If you only logged 5 days, c = 5/7 = 0.714, and all scores get scaled down."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"s0 (starting open)"}),": Number of todos that existed at the start of the week and weren't completed yet."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"add (added)"}),": New todos created during the week."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"close (closed)"}),": Todos completed during the week."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"t (throughput)"}),": How fast you close tasks = close / s0. Example: closed 5 out of 10 open tasks = 5/10 = 50%."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"h (hygiene)"}),": Backlog health based on net change = (close - add) / s0. If net ≥ 0 (shrinking backlog), h = 50-100%. If net < 0 (growing backlog), h = 0-50%."]}),(0,s.jsxs)("li",{children:[(0,s.jsx)("strong",{children:"Backlog health score"}),": 100 \xd7 (0.6t + 0.4h). Rewards both closing tasks (throughput) and shrinking the backlog (hygiene). Closing 5 and adding 2 (net +3) scores better than closing 5 and adding 8 (net -3)."]})]})]})]})}let N=JSON.parse('{"management":{"weeklyLogSetup":true,"dailyLoggedDays":6,"financeLogSetup":true},"learning":{"loggedDays":6,"learningArtifactsCount":4,"revisionNotesCreated":2,"revisionRevisitPoints":15,"learningTodo":{"s0":8,"add":3,"close":5}},"producer":{"publicOutputsCount":1,"producerTodo":{"s0":5,"add":2,"close":3}},"finance":{"income":50000,"spend":28000,"spendCap":12500,"targetSavingsRate":0.4,"financeConceptApplied":"implemented","portfolioReview":"ips_checked","financeTodo":{"s0":3,"add":1,"close":2}},"fitness":{"loggedDays":7,"gymSessions":4,"avgWeightActual":72.5,"targetWeight":72,"caloriesTrackedDays":6,"fitnessTodo":{"s0":4,"add":1,"close":3}},"relationship":{"newInteractions":4,"familyCalls":2,"unresolvedConflicts":0,"primaryRelationshipActive":true,"relationshipTodo":{"s0":2,"add":1,"close":2}},"targets":{"artifactsPerWeek":3,"gymSessionsPerWeek":3,"newInteractionsPerWeek":3,"familyCallsPerWeek":2}}');async function M(e){try{let t=(0,c.P)((0,c.rJ)(l.db,"public_metrics")),n=(await (0,c.GG)(t)).docs.map(e=>(0,c.kd)((0,c.H9)(l.db,"public_metrics",e.id)));await Promise.all(n),await (0,c.gS)((0,c.rJ)(l.db,"public_metrics"),{...e,updatedAt:new Date().toISOString()}),console.log("Public metrics saved successfully")}catch(e){throw console.error("Error saving public metrics:",e),e}}function W(){var e,t;let{user:n,loading:r,logOut:d}=(0,m.A)(),g=(0,a.useRouter)(),[u,x]=(0,i.useState)(null),[f,y]=(0,i.useState)([]),[v,w]=(0,i.useState)(!0),[j,k]=(0,i.useState)(null),[b,C]=(0,i.useState)(!1),[W,T]=(0,i.useState)("current");async function _(){await d(),g.push("/metrics/login")}return((0,i.useEffect)(()=>{!async function(){if(!n&&!r){try{let e=await fetch("/public-metrics.json");if(!e.ok)throw Error("Failed to fetch public metrics");let t=await e.json();t.currentWeek&&t.allWeeks?(x(t.currentWeek.scores),y(t.allWeeks),C(!1)):(x(p(N)),C(!0)),w(!1)}catch(e){console.error("Error fetching public metrics:",e),x(p(N)),C(!0),w(!1)}return}if(n)try{let e=(0,c.P)((0,c.rJ)(l.db,"weekly_logs"),(0,c.My)("weekStart","desc")),t=await (0,c.GG)(e);if(t.empty){console.warn("No weekly logs found, using sample data"),x(p(N)),C(!0),w(!1);return}let n=(await (0,c.GG)((0,c.rJ)(l.db,"expenses"))).docs.map(e=>e.data()),s=(await (0,c.GG)((0,c.rJ)(l.db,"income"))).docs.map(e=>e.data()),i=(await (0,c.GG)((0,c.rJ)(l.db,"todos"))).docs.map(e=>({id:e.id,...e.data()})),r=await (0,c.GG)((0,c.rJ)(l.db,"budget_targets")),o=r.empty?null:r.docs[0].data(),a=[];for(let e of t.docs){let t=e.data(),r=t.weekStart,d=t.weekEnd,g=(0,c.P)((0,c.rJ)(l.db,"daily_logs"),(0,c._M)("date",">=",r),(0,c._M)("date","<=",d),(0,c.My)("date","asc")),m=(await (0,c.GG)(g)).docs.map(e=>e.data()),u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!t)throw Error("Weekly log is required");let o=t.weekStart,a=t.weekEnd,l=e.filter(e=>{var t;return t=e.date,t>=o&&t<=a}),c=["learning","producer","finance","fitness","relationship"].map(e=>(function(e,t,n,s){let i=e.filter(e=>e.label===s),r=i.filter(e=>{let n=e.sourceDate<t,s=!e.completed,i=e.completed&&e.completedDate&&e.completedDate>=t;return n&&(s||i)}).length,o=i.filter(e=>e.sourceDate>=t&&e.sourceDate<=n).length;return{label:s,openCount:r,addedCount:o,closedCount:i.filter(e=>e.completed&&e.completedDate&&e.completedDate>=t&&e.completedDate<=n).length}})(n,o,a,e)),d=l.map(e=>{let t=(0,h.Zg)(e.tasksMarkdown);return(0,h.zP)(t)}),g=l.filter(e=>e.logged).length,p=l.filter(e=>e.logged).length,m=d.reduce((e,t)=>e+t.learningArtifacts,0),u=d.reduce((e,t)=>e+t.revisionNotesCreated,0),x=d.reduce((e,t)=>e+t.revisionPointsReviewed,0),f=c.find(e=>"learning"===e.label),y=f?{s0:f.openCount,add:f.addedCount,close:f.closedCount}:{s0:0,add:0,close:0},v=d.reduce((e,t)=>e+t.publicOutputs,0),w=c.find(e=>"producer"===e.label),j=w?{s0:w.openCount,add:w.addedCount,close:w.closedCount}:{s0:0,add:0,close:0},k=s.filter(e=>e.date<=a),b=i.filter(e=>e.date<=a),C=k.reduce((e,t)=>e+t.amount,0),S=b.reduce((e,t)=>e+t.amount,0),N=c.find(e=>"finance"===e.label),M=N?{s0:N.openCount,add:N.addedCount,close:N.closedCount}:{s0:0,add:0,close:0},W=S>0||C>0||M.s0+M.add+M.close>0,T=l.filter(e=>e.logged).length,_=l.filter(e=>e.gymSession).length,A=l.filter(e=>e.weight&&e.weight>0).map(e=>e.weight),P=A.length>0?A.reduce((e,t)=>e+t,0)/A.length:0,F=l.filter(e=>e.caloriesTracked).length,B=c.find(e=>"fitness"===e.label),D=B?{s0:B.openCount,add:B.addedCount,close:B.closedCount}:{s0:0,add:0,close:0},R=d.reduce((e,t)=>e+t.newInteractions,0),I=d.reduce((e,t)=>e+t.familyCalls,0),L=+!!d.some(e=>e.unresolvedConflicts>0),E=c.find(e=>"relationship"===e.label),G=E?{s0:E.openCount,add:E.addedCount,close:E.closedCount}:{s0:0,add:0,close:0},z=(0,h.Kk)(t.tasksMarkdown),O=t.financeConceptApplied||z.financeConceptApplied,J=t.portfolioReview||z.portfolioReview;return{management:{weeklyLogSetup:!0,dailyLoggedDays:g,financeLogSetup:W},learning:{loggedDays:p,learningArtifactsCount:m,revisionNotesCreated:u,revisionRevisitPoints:x,learningTodo:y},producer:{publicOutputsCount:v,producerTodo:j},finance:{income:S,spend:C,spendCap:(null==r?void 0:r.weeklySpendCap)||0,targetSavingsRate:(null==r?void 0:r.targetSavingsRate)||.4,financeConceptApplied:O,portfolioReview:J,financeTodo:M},fitness:{loggedDays:T,gymSessions:_,avgWeightActual:P,targetWeight:t.targetWeight,caloriesTrackedDays:F,fitnessTodo:D},relationship:{newInteractions:R,familyCalls:I,unresolvedConflicts:L,primaryRelationshipActive:t.primaryRelationshipActive,relationshipTodo:G},targets:{artifactsPerWeek:3,gymSessionsPerWeek:3,newInteractionsPerWeek:3,familyCallsPerWeek:2}}}(m,t,i,n,s,o),x=p(u);a.push({weekStart:r,weekEnd:d,scores:x})}if(x(a[0].scores),y(a),C(!1),w(!1),a.length>0)try{await M({currentWeek:a[0],allWeeks:a,updatedAt:new Date().toISOString()})}catch(e){console.error("Failed to save public metrics:",e)}}catch(e){console.error("Error fetching metrics:",e),k("Failed to load metrics data"),x(p(N)),C(!0),w(!1)}}()},[n,r]),r||v)?(0,s.jsx)("main",{className:"metrics-container",children:(0,s.jsx)("p",{style:{textAlign:"center",color:"var(--text-secondary)"},children:"Loading..."})}):j&&!b?(0,s.jsx)("main",{className:"metrics-container",children:(0,s.jsx)("p",{style:{textAlign:"center",color:"#ef4444"},children:j})}):(0,s.jsxs)("main",{className:"metrics-container",children:[(0,s.jsxs)("nav",{style:{marginBottom:"20px",display:"flex",gap:"15px",alignItems:"center",flexWrap:"wrap"},children:[(0,s.jsx)(o(),{href:"/",style:{color:"#0066cc"},children:"← Back"}),(0,s.jsx)("span",{style:{color:"var(--text-secondary)"},children:"|"}),(0,s.jsx)(o(),{href:"/metrics/daily",style:{color:"#0066cc"},children:"Daily Log"}),(0,s.jsx)(o(),{href:"/metrics/weekly",style:{color:"#0066cc"},children:"Weekly Log"}),(0,s.jsx)(o(),{href:"/metrics/todo",style:{color:"#0066cc"},children:"Todo Tracking"}),(0,s.jsx)(o(),{href:"/metrics/finance",style:{color:"#0066cc"},children:"Finance"}),n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{style:{color:"var(--text-secondary)"},children:"|"}),(0,s.jsx)("span",{style:{color:"var(--text-secondary)",fontSize:"14px"},children:n.email}),(0,s.jsx)("button",{onClick:_,style:{padding:"4px 12px",background:"transparent",color:"#ef4444",border:"1px solid #ef4444",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Logout"})]}),!n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{style:{color:"var(--text-secondary)"},children:"|"}),(0,s.jsx)(o(),{href:"/metrics/login",style:{color:"#0066cc"},children:"Login"})]})]}),(0,s.jsxs)("div",{className:"metrics-header",children:[(0,s.jsx)("h1",{className:"metrics-title",children:"Life Metrics"}),(0,s.jsxs)("p",{className:"metrics-subtitle",children:["Weekly tracking across 6 dimensions • Updates every Monday",b&&(0,s.jsx)("span",{style:{color:"#eab308",marginLeft:"10px"},children:"(Using sample data - no logs found)"})]})]}),(0,s.jsxs)("div",{style:{marginBottom:"30px",display:"flex",gap:"10px",borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsx)("button",{onClick:()=>T("current"),style:{padding:"10px 20px",background:"transparent",color:"current"===W?"#0066cc":"var(--text-secondary)",border:"none",borderBottom:"current"===W?"2px solid #0066cc":"2px solid transparent",cursor:"pointer",fontWeight:"current"===W?"600":"400"},children:"Current Week"}),(0,s.jsx)("button",{onClick:()=>T("history"),style:{padding:"10px 20px",background:"transparent",color:"history"===W?"#0066cc":"var(--text-secondary)",border:"none",borderBottom:"history"===W?"2px solid #0066cc":"2px solid transparent",cursor:"pointer",fontWeight:"history"===W?"600":"400"},children:"All Weeks History"})]}),"current"===W&&u&&(0,s.jsx)(S,{scores:u,weekStart:null==(e=f[0])?void 0:e.weekStart,weekEnd:null==(t=f[0])?void 0:t.weekEnd}),"history"===W&&(0,s.jsxs)("div",{style:{overflowX:"auto"},children:[(0,s.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[(0,s.jsx)("th",{style:{padding:"12px",textAlign:"left"},children:"Week"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Management"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Learning"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Producer"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Finance"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Fitness"}),(0,s.jsx)("th",{style:{padding:"12px",textAlign:"center"},children:"Relationship"})]})}),(0,s.jsx)("tbody",{children:f.map(e=>(0,s.jsxs)("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[(0,s.jsxs)("td",{style:{padding:"12px"},children:[e.weekStart," to ",e.weekEnd]}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.management.score.toFixed(1)}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.learning.score.toFixed(1)}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.producer.score.toFixed(1)}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.finance.score.toFixed(1)}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.fitness.score.toFixed(1)}),(0,s.jsx)("td",{style:{padding:"12px",textAlign:"center"},children:e.scores.relationship.score.toFixed(1)})]},e.weekStart))})]}),0===f.length&&(0,s.jsx)("p",{style:{textAlign:"center",padding:"40px",color:"var(--text-secondary)"},children:"No weekly logs found"})]})]})}},9907:()=>{}},e=>{e.O(0,[603,992,138,913,619,477,670,441,255,358],()=>e(e.s=2880)),_N_E=e.O()}]);